#!/bin/sh

set -e

TARGET_SCRIPT="$1"
GNC_OVERRIDES_DIR="$2"

rm -f ${TARGET_SCRIPT}.tmp

cat > ${TARGET_SCRIPT}.tmp <<EOF
#!/bin/sh
PATH="${GNC_OVERRIDES_DIR}:\${PATH}"
export PATH

GUILE_WARN_DEPRECATED="no"
export GUILE_WARN_DEPRECATED

(echo \$LANG | grep -v UTF-8 > /dev/null ) && \
 LANG=\`echo \$LANG | sed s/$LANG/$LANG\.UTF-8/\` && \
echo UTF-8 support is required. Setting LANG to \$LANG

exec "${TARGET_SCRIPT}" "\$@"
EOF

mv ${TARGET_SCRIPT}.tmp ${TARGET_SCRIPT}
chmod u+x ${TARGET_SCRIPT}
